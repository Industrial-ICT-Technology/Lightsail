{% extends 'base.html' %} {% load static %} {% block style %}
<link rel="stylesheet" href="{% static 'mainapp/css/workStatus.css' %}?after" />
{% endblock %} {% block content-title %}
<h2 class="content-title fs-large fw-600 gray-200">Data Status</h2>
{% endblock %} {% block content %}

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>



<div class="first-desc primary-bg gray-100">
  <div class="first-desc-wrap">
    

    <form style="display: inline-block" action="" method="get" class="first" name="afgsgd">
      {% csrf_token %}
      <p class="subject">제품 선택</p>
      <select name="category_product" id="product_select">
        {% for product_name in product_names %}
    
        <option value="{{ product_name.category_product }}"
          {% if forloop.first %} selected {% endif %}>
          {{ product_name.category_product }}
        </option>
          {% endfor %}
      </select>
    </form>
    
<script> // 제품 선택
  document.addEventListener("DOMContentLoaded", function() {
    var select = document.getElementById("product_select");
    var storedValue = localStorage.getItem("product_select");
    if (storedValue) {
      select.value = storedValue;
    }
    select.addEventListener("change", function() {
      localStorage.setItem("product_select", this.value);
    });
  });

  $(document).ready(function() {
    $('#product_select').change(function() {
      $('form[name="afgsgd"]').submit();
    });
  });
</script>


    <div class="totalBar">
      <div class="right_top top1">총 개수 {{ alltotal }}</div>
      <div class="right_top top2">작업완료 {{ first_num }}</div>
      <div class="right_top top3">검수완료 {{ second_num }}</div>
      <div class="right_top top4">삭제 {{ dummy_num }}</div>
    </div>

    <div class="workStatus_now">
      <a href="{% url 'mainapp:workstatus_count' %}" style="display: block"
        >작업자별 진행 현황</a
      >
    </div>
    <div class="category_wrap">
      <div class="category category_1">
        <div class="category_column">  
          <table>
            <thead>
              <tr>
                <th> <div class="data_label label1"style="width:99px"  >카테고리↓</div></th>
                <th><div class="data_label"style="width:71px">
                  <a href="#" onclick="return chk_form('positive_sort')">긍정↓</a>
                  <form method="post" class="sort">
                    {% csrf_token %}
                    <input type="hidden" name="sort" value="positive" />
                  </form>
                </div></th>
                <th><div class="data_label"style="width:71px">
                  <a href="#" onclick="return chk_form('negative_sort')">부정↑</a>
                  <form method="post" class="sort" id="negative_sort">
                    {% csrf_token %}
                    <input type="hidden" name="sort" value="negative" />
                  </form>
                </div></th>
                <th><div class="data_label"style="width:71px">
                  <a href="#" onclick="return chk_form('neutral_sort')">중립↓</a>
                  <form method="post" class="sort" id="neutral_sort">
                    {% csrf_token %}
                    <input type="hidden" name="sort" value="neutral" />
                  </form>
                </div></th>
                <th><div class="data_label"style="width:71px">
                  <a href="#" onclick="return chk_form('everything_sort')">총개수↓</a>
                  <form method="post" class="sort" id="everything_sort">
                    {% csrf_token %}
                    <input type="hidden" name="sort" value="everything" />
                  </form>
                </div></th>
              </tr>
            </thead>
              <tbody>
                
                {% for category_detail_list, positive, negative, neutral, everything,order in  data %}

                <tr>
                  <td><div class="date_space_cut cut1"style="width:99px">
                    <p>{{ category_detail_list }}</p>
                  </div>
                  </td>
                  <td><div class="date_space_cut"style="width:71px" >
                    <p>
                      <a
                        href="?category_product={{ category_product }}&showing_index={{ order }}&showing_type=positive"
                        >{{ positive.count }}</a
                      >
                    </p>
                  </div>
                  </td>
                  <td><div class="date_space_cut"style="width:71px" >
                    <p>
                      <a
                        href="?category_product={{ category_product }}&showing_index={{ order }}&showing_type=negative"
                        >{{ negative.count }}</a
                      >
                    </p>
                  </div>
                  </td>
                  <td> <!-- 중립 개수 -->
                    <div class="date_space_cut" style="width:71px">
                      <p>
                        <a
                          href="?category_product={{ category_product }}&showing_index={{ order }}&showing_type=neutral"
                          >{{ neutral.count }}</a
                        >
                      </p>
                    </div>
                  </td>
                  <td><div class="date_space_cut"style="width:71px" >
                    <p>
                      <a
                        href="?category_product={{ category_product }}&showing_index={{ order }}&showing_type=everything"
                        >{{ everything.count }}</a
                      >
                    </p>
                  </div>       
                </td>
                </tr>
                {% endfor %}
            
              </tbody>
          </table> 
        
        </div>
      </div>
     
      
      <div class="category category_2">
        <div class="category_target">
          <table>
            <thead>
              <tr>
                <th><div class="data_label"style="width:99px"               >대상</div></th>
                <th><div class="data_label"style="width:99px">현상</div></th>
              </tr>
            </thead>
            <tbody>
              {% for word in labeled_word %}
              <tr>
                <td><div class="date_space_cut cut2" style="font-style: normal;
                  font-weight: 400;
                  font-size: 12px;
                  line-height: 24px;
                  ">
                  {{ word.first_labeled_target }}
                </div></td>
                <td><div class="date_space_cut cut2" style="font-style: normal;
                  font-weight: 400;
                  font-size: 12px;
                  line-height: 24px;
                  ">
                  {{ word.first_labeled_expression }}
                </div></td>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
      <div class="category category_3">
        <div class="category_review">
          <table>
            <thead>
              <tr>
                <th><div class="data_label" style="
                  width:67px">번호</div></th>
                <th><div class="data_label"style="
                  width:380px">데이터</div></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                {% for review in labeled_review %}
              </tr>
              <td class="date_space_cut" style="width:67px">
                {{ review.review_number }}
              </td>
              <td class="date_space_cut" style="font-style: normal;
              font-weight: 400;
              font-size: 12px;
              line-height: 24px;
              width:380px">
                {{ review.review_content }}
              </td>
              {% endfor %}
            </tbody>
          </table>                
        </div>
      </div>
    </div>

    <button id="myBtn">Open Popup</button>

<div id="myModal" class="popup">
  <div class="popup-content">
    <span class="close">&times;</span>
    <div>{% include workstatus_count.html %}</div>
    <div id="modal-content">
    
    </div>
    {}
  </div>
</div>

<script>
$(document).ready(function(){
  $("#myBtn").click(function(){
    
    $("#myModal").show();
  });
  $(".close").click(function(){
    $("#myModal").hide();
  });
});
</script>
  </div>
</div>
<style>
  .popup {
    display: none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.4);
    padding-left: 546px;
    padding-top : 147px
    
  }
  .popup-content {
    background-color: white;
    padding : 27.5px 33px 40px 33px;
    border: 1px solid #888;
     width: 598px;
    height: 529px; 
    border-radius: 5px;
  }
.pop_subject{
  display: inline-block;
    margin-right: 15px;
    
    font-size: 16px;
    font-weight: 400;
    line-height: 24px;
    letter-spacing: 0em;
    text-align: left;
}

  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
  }
  .close:hover, .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }
</style>
{% endblock %}
